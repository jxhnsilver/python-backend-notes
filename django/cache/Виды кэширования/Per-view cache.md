–≠—Ç–æ **–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π view-—Ñ—É–Ω–∫—Ü–∏–∏**.  
Django **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç HTTP-–æ—Ç–≤–µ—Ç** (HTML, JSON –∏ —Ç.–¥.) –∏ **–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –∏–∑ –∫—ç—à–∞ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö**, **–Ω–µ –∑–∞–ø—É—Å–∫–∞—è —Å–∞–º—É view**.

‚Üí –£—Å–∫–æ—Ä—è–µ—Ç **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç—è–∂—ë–ª—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã**, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è –æ—Å—Ç–∞–ª—å–Ω–æ–π —Å–∞–π—Ç.
## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ë–∞–∑–æ–≤–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
```python
from django.views.decorators.cache import cache_page

@cache_page(60 * 15)  # –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å 15 –º–∏–Ω—É—Ç
def product_list(request):
    # –¢—è–∂—ë–ª–∞—è –ª–æ–≥–∏–∫–∞, –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î...
    return render(request, "products.html", {"items": items})
```
- –ê—Ä–≥—É–º–µ–Ω—Ç ‚Äî **—Ç–∞–π–º–∞—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö**.
- –ö—ç—à **–ø—Ä–∏–≤—è–∑–∞–Ω –∫ –ø–æ–ª–Ω–æ–º—É URL**, –≤–∫–ª—é—á–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:  
    `/products/?category=shoes` ‚â† `/products/?category=hats`.
## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### 1. `cache` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∫—ç—à
```python
@cache_page(60 * 15, cache="special_cache")
def my_view(request):
    ...
```
‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±—ç–∫–µ–Ω–¥ –∏–∑ `CACHES["special_cache"]`, –∞ –Ω–µ `"default"`.
### 2. `key_prefix` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å –¥–ª—è view
```python
@cache_page(60 * 15, key_prefix="v2")
def my_view(request):
    ...
```
‚Üí –ü–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ª–æ–≥–∏–∫–∏: —Å–º–µ–Ω–∏–ª `v2` ‚Üí —Å—Ç–∞—Ä—ã–π –∫—ç—à –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.

> –ü—Ä–µ—Ñ–∏–∫—Å –∏–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ **–∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–µ—Ç—Å—è** —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º `KEY_PREFIX` –∏–∑ `CACHES`.

## HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏

Django **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –æ—Ç–≤–µ—Ç:
```http
Cache-Control: max-age=900
Expires: <—Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è + 900 —Å–µ–∫>
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

- **–ö–ª—é—á –∫—ç—à–∞** = —Ö—ç—à –æ—Ç:
    - –ø–æ–ª–Ω–æ–≥–æ URL (–≤–∫–ª—é—á–∞—è query-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã),
    - –º–µ—Ç–æ–¥–∞ –∑–∞–ø—Ä–æ—Å–∞ (`GET`),
    - –ø—Ä–µ—Ñ–∏–∫—Å–∞ (`key_prefix`),
    - —è–∑—ã–∫–∞ (–µ—Å–ª–∏ `USE_I18N=True`),
    - —Ç–∞–π–º–∑–æ–Ω—ã (–µ—Å–ª–∏ `USE_TZ=True`).
- –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ:
    - –µ—Å–ª–∏ –∫–ª—é—á –µ—Å—Ç—å –≤ –∫—ç—à–µ ‚Üí **–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π HttpResponse**,
    - –µ—Å–ª–∏ –Ω–µ—Ç ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è view, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.
## ‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

|–°—Ü–µ–Ω–∞—Ä–∏–π|–ü–æ–¥—Ö–æ–¥–∏—Ç?|
|---|---|
|–ü—É–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ç—è–∂—ë–ª–æ–π –ª–æ–≥–∏–∫–æ–π (–¢–û–ü —Ç–æ–≤–∞—Ä–æ–≤, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞)|‚úÖ –î–∞|
|API-—ç–Ω–¥–ø–æ–∏–Ω—Ç —Å —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—â–∏–º–∏—Å—è –¥–∞–Ω–Ω—ã–º–∏|‚úÖ –î–∞|
|–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç)|‚ùå –ù–µ—Ç (–≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—Ç –æ–¥–∏–Ω –æ—Ç–≤–µ—Ç)|
|–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —á–∞—Å—Ç—ã–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏|‚ö†Ô∏è –¢–æ–ª—å–∫–æ —Å –∫–æ—Ä–æ—Ç–∫–∏–º TTL|

> üí° –î–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Äî –∫—ç—à–∏—Ä—É–π **—Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ view**, –∞ –Ω–µ –≤–µ—Å—å –æ—Ç–≤–µ—Ç.

## –ö–∞–∫ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à?

Django **–Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä—è–º–æ–≥–æ API** –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ per-view –∫—ç—à–∞ (–ø–æ—Ç–æ–º—É —á—Ç–æ –∫–ª—é—á –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).

### –†–µ—à–µ–Ω–∏—è:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `key_prefix`** –∏ –º–µ–Ω—è—Ç—å –µ–≥–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
```python
@cache_page(60 * 15, key_prefix="products_v3")
def product_list(request): ...
```
2. **–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ view –≤—Ä—É—á–Ω—É—é** (—á–µ—Ä–µ–∑ `cache.get/set`) ‚Äî —Ç–æ–≥–¥–∞ —Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å –∫–ª—é—á–∏ –∏ –º–æ–∂–µ—à—å –≤—ã–∑—ã–≤–∞—Ç—å `cache.delete()`.
## Per-view vs Per-site cache

| –ö—Ä–∏—Ç–µ—Ä–∏–π      | Per-view                                   | Per-site                   |
| ------------- | ------------------------------------------ | -------------------------- |
| –ì—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å | –û—Ç–¥–µ–ª—å–Ω—ã–µ view                             | –í–µ—Å—å —Å–∞–π—Ç                  |
| –ì–∏–±–∫–æ—Å—Ç—å      | ‚úÖ –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å, —á—Ç–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å            | ‚ùå –í—Å—ë –∏–ª–∏ –Ω–∏—á–µ–≥–æ           |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å  | ‚úÖ –ú–æ–∂–Ω–æ –∏–∑–±–µ–≥–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö | ‚ùå –û–ø–∞—Å–Ω–æ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏   |
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞     | –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –Ω–∞–¥ view                         | Middleware –≤ `settings.py` |

## –í—ã–≤–æ–¥

> **Per-view cache ‚Äî —ç—Ç–æ –∑–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞**:
> 
> - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π (–ø—Ä–æ—Å—Ç–æ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä),
> - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥–∏–±–∫–∏–π (–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å, —á—Ç–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å),
> - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π (–Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–π —Å–∞–π—Ç).

–ù–∞ —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–µ –∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ ‚Äî **–∏—Å–ø–æ–ª—å–∑—É–π –µ–≥–æ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö, —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—â–∏—Ö—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü**.  
–î–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∏–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Äî **–∫—ç—à–∏—Ä—É–π —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ view**, –∞ –Ω–µ –≤–µ—Å—å HTTP-–æ—Ç–≤–µ—Ç.